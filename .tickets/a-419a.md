---
id: a-419a
status: closed
deps: [a-ad8e]
links: []
created: 2026-01-06T22:18:21Z
type: feature
priority: 1
assignee: Jack Coughlin
---
# Phase 6: Update top-level solvers for multi-species coordination

Update VlasovPoissonFokkerPlanck and VlasovMaxwell to coordinate multi-species evolution with Fokker-Planck collisions.

## Design

**VlasovPoissonFokkerPlanck:**
- Signature: `__call__(f_dict, a, prev_ex, dex_array, nu_fp_prof, nu_K_prof)`
- Returns: `e[nx], f_dict_new, diags`
- Calls integrator with `f_dict` (integrator handles multi-species)
- Fokker-Planck applied at higher level (VlasovMaxwell) per species

**VlasovMaxwell:**
- Signature: `__call__(t, y, args)` where y contains species dicts
- Extract `f_dict = {name: y[name] for name in species_names}`
- Call VPFP with `f_dict`
- Apply Fokker-Planck operator independently to each species
- Return state with all species distributions

Constructor changes:
- Store `species_params` and `species_names`
- Pass through to integrators

## Files
- `adept/_vlasov1d/solvers/vector_field.py` (VlasovPoissonFokkerPlanck, VlasovMaxwell)

## Acceptance Criteria
- Full solver runs multi-species simulations end-to-end
- Fokker-Planck operates independently on each species
- State dict structure maintained correctly
- Diagnostics work for multi-species
