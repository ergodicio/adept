---
id: a-58a6
status: in_progress
deps: [a-651d]
links: []
created: 2026-01-06T22:18:21Z
type: feature
priority: 1
assignee: Jack Coughlin
---
# Phase 4: Update field solvers for multi-species charge/current density

Modify field solvers to receive `f_dict` and compute total charge/current density from all species.

## Design

Field solvers now operate on dicts of distributions, computing charge density as ρ = Σ_s q_s ∫f_s dv_s.

**SpectralPoissonSolver:**
- Constructor: `__init__(kx, species_grids, species_params, ...)`
- Call signature: `__call__(f_dict, dex_array, prev_ex)` → returns `e[nx]`
- Loops over species to compute total charge density
- Uses species-specific `dv_s` for integration

**AmpereSolver and HampereSolver:**
- Similar structure for Maxwell solvers
- Compute total current density: j = Σ_s (q_s/m_s) ∫v f_s dv
- Note: May need 1D2V for proper current calculation (document limitation)

## Files
- `adept/_vlasov1d/solvers/pushers/field.py`

## Acceptance Criteria
- Field solvers handle dict input correctly
- Total charge density computed correctly from multiple species
- Unit test: Two distributions with q=-1, q=+1 should cancel if equal densities
- Poisson equation solved correctly with multi-species charge density
